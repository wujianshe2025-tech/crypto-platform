# ⚡ 快速集成指南 - 预测投票钱包支付功能

## 🎯 目标
在现有的 `index.html` 中添加真实的钱包连接和USDT支付功能

---

## 📋 3步快速集成

### 步骤1：添加Ethers.js（1分钟）

在 `index.html` 的 `<head>` 部分，找到：
```html
<script src="https://cdn.tailwindcss.com"></script>
```

在它下面添加：
```html
<script src="https://cdn.ethers.io/lib/ethers-5.2.umd.min.js"></script>
```

### 步骤2：修改导航栏（1分钟）

找到导航栏中的：
```html
<div class="text-sm text-gray-400">真实数据版</div>
```

替换为：
```html
<div id="wallet-status" class="flex items-center gap-3">
    <button id="connect-wallet-btn" onclick="connectWallet()" 
            class="px-4 py-2 bg-blue-600 rounded-lg hover:bg-blue-700 transition">
        连接钱包
    </button>
</div>
```

### 步骤3：集成JavaScript代码（5分钟）

打开 `预测投票-钱包支付集成补丁.js` 文件，按照以下顺序复制代码到 `index.html` 的 `<script>` 标签中：

#### 3.1 添加配置（在最开始）
```javascript
// 复制 "配置" 部分的代码
const API_URL = 'http://localhost:3000';
const USDT_ADDRESS = '0x55d398326f99059fF775485246999027B3197955';
// ... 等等
```

#### 3.2 添加全局变量
```javascript
// 复制 "全局变量" 部分
let currentUser = null;
let userToken = null;
// 注意：isMember 已存在，不要重复声明
```

#### 3.3 添加新函数
复制以下函数到 `<script>` 中：
- `connectWallet()`
- `updateWalletStatus()`
- `logout()`
- `checkLoginStatus()`
- `updateMemberStatus()`
- `loadPredictions()`

#### 3.4 替换现有函数
找到并替换：
- `becomeMember()` - 替换为真实支付版本
- `createPrediction()` - 替换为API集成版本
- `votePrediction()` - 替换为API集成版本

#### 3.5 添加初始化代码（在最后）
```javascript
document.addEventListener('DOMContentLoaded', function() {
    checkLoginStatus();
    if (currentUser) {
        loadPredictions();
    }
});

if (typeof window.ethereum !== 'undefined') {
    window.ethereum.on('accountsChanged', function(accounts) {
        if (accounts.length === 0) {
            logout();
        }
    });
}
```

---

## ✅ 完成！

现在你的网站已经集成了：
- ✅ MetaMask钱包连接
- ✅ 真实USDT支付
- ✅ 后端API集成
- ✅ 用户登录状态管理

---

## 🧪 测试

1. **测试钱包连接**
   - 打开网站
   - 点击"连接钱包"
   - 在MetaMask中确认

2. **测试会员支付**
   - 连接钱包后
   - 点击"成为会员"
   - 支付1 USDT

3. **测试创建预测**
   - 成为会员后
   - 点击"发起预测"
   - 填写并创建

4. **测试投票**
   - 选择预测
   - 点击选项投票

---

## 📞 需要帮助？

查看详细文档：
- 📖 `✅预测投票-钱包支付集成说明.md` - 完整集成说明
- 📖 `预测投票-钱包支付集成补丁.js` - 完整代码

---

**预计时间：** 10分钟  
**难度：** ⭐⭐ 简单

